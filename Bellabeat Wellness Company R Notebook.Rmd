---
title: "Case Study: How Can a Wellness Technology Company Play It Smart?"
output:
  html_document:
    df_print: paged
---

This is a capstone project as a part of the Google Data Analytics Professional Certificate course. The project involves using R programming language and RStudio IDE to analyse a dataset. The project follows six steps: Ask, Prepare, Process, Analyse, Share, and Act. These steps involve defining the problem or question to be answered, preparing and cleaning the data, analysing the data statistically and through visualisations, sharing the insights obtained from the analysis, and taking action based on those insights.


# 1. Ask

### Business Task:

Analyse smart device fitness data to gain insights into how consumers are using their smart devices and use this information to guide the marketing strategy for one of Bellabeat's products.

### Key stakeholders:

* Urska Srsen, Bellabeat's cofounder and Chief Creative Officer
* Sando Mur, Bellabeat's cofounder and Mathematician
* Bellabeat marketing analytics team
* Bellabeat executive team
* Bellabeat's customers

### Statement of the business task:

Analyse smart device data to understand trends in usage and how these trends can be applied to Bellabeat's product offerings. Provide high-level recommendations on how these trends can inform Bellabeat's marketing strategy for one of their products.


# 2. Prepare

* The dataset is downloaded from this [link](https://www.kaggle.com/datasets/arashnic/fitbit).
* Data Source: 30 participants FitBit Fitness Tracker Data 
* The dataset has 18 CSV. The data also follow a ROCCC approach:
   * Reliability: The data is from 30 FitBit users who consented to the submission of personal tracker data and generated by from a distributed survey via Amazon Mechanical   
     Turk.
   * Original: The data is from 30 FitBit users who consented to the submission of personal tracker data via Amazon Mechanical Turk.
   * Comprehensive: Data minute-level output for physical activity, heart rate, and sleep monitoring. While the data tracks many factors in the user activity and sleep, but the 
    sample size is small and most data is recorded during certain days of the week.
   * Current: Data is from March 2016 to May 2016. Data is not current so the users habit may be different now.
   * Cited: Unknown.
* The dataset has limitations:
  * Only 30 user data is available. The central limit theorem general rule of n???30 applies and we can use the t test for statstic reference. However, a larger sample size is 
    preferred for the analysis.
  * Upon further investigation with n_distinct() to check for unique user Id, the set has 33 user data from daily activity, 24 from sleep and only 8 from weight. There are 3 
    extra users and some users did not record their data for tracking daily activity and sleep.
  * For the 8 user data for weight, 5 users manually entered their weight and 3 recorded via a connected wifi device (eg: wifi scale).
  * Most data is recorded from Tuesday to Thursday, which may not be comprehensive enough to form an accurate analysis.

# 3. Process

The libraries and dataset are loaded in RStudio environment and the data is prepared for analysis by doing necessary cleaning, manipulation, and transformation.

### Loading necessary packages

```{r}
install.packages('tidyverse', repos = "http://cran.us.r-project.org")
install.packages('skimr', repos = "http://cran.us.r-project.org")
install.packages('cowplot', repos = "http://cran.us.r-project.org")
install.packages("htmltools", repos = "http://cran.us.r-project.org")
install.packages("plotly", version = "4.8.0", repos = "http://cran.us.r-project.org")
library(tidyverse)             # wrangle data
library(dplyr)                 # clean data
library(lubridate)             # wrangle date attributes
library(skimr)                 # get summary data
library(ggplot2)               # visualise data
library(cowplot)               # grid the plot
library(readr)                 # save csv 
library(plotly)                # pie chart
options(scipen = 999)
```

### Loading the data

```{r}
daily_activity <- read.csv("C:/Users/arpit/OneDrive/Desktop/Projects/Bellabeat Case Study/R Dataset/dailyActivity_merged.csv")
sleep_day <- read.csv("C:/Users/arpit/OneDrive/Desktop/Projects/Bellabeat Case Study/R Dataset/sleepDay_merged.csv")
weight <- read.csv("C:/Users/arpit/OneDrive/Desktop/Projects/Bellabeat Case Study/R Dataset/weightLogInfo_merged.csv")
hourly_step <- read.csv("C:/Users/arpit/OneDrive/Desktop/Projects/Bellabeat Case Study/R Dataset/hourlySteps_merged.csv")
head(daily_activity)
head(sleep_day)
head(weight)
head(hourly_step)
```

### Data Cleaning and Manipulation

Checking for NA values

```{r}
sum(is.na(daily_activity))
sum(is.na(sleep_day))
sum(is.na(weight))
```
* The NA values in the weight dataset can be ignored because those belong to "Fat" data of different dates. 


Checking for duplicates

```{r}
sum(duplicated(daily_activity))
sum(duplicated(sleep_day))
sum(duplicated(weight))
```


Removing the duplicates

```{r}
sleep_day <- sleep_day[!duplicated(sleep_day), ]
sum(duplicated(sleep_day))
```


Adding a new column for the weekdays

```{r}
library(dplyr)
daily_activity <- daily_activity %>% mutate( Weekday = weekdays(as.Date(ActivityDate, "%m/%d/%Y")))
```


Merging the daily activity and sleep_day datasets

```{r}
merged1 <- merge(daily_activity,sleep_day,by = c("Id"), all=TRUE)
merged_data <- merge(merged1, weight, by = c("Id"), all=TRUE)
```


Ordering the weekdays from Monday to Sunday

```{r}
merged_data$Weekday <- factor(merged_data$Weekday, levels= c("Monday", 
    "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"))
merged_data[order(merged_data$Weekday), ]
```

```{r}
head(merged_data)
```


Changing the format of Hourly Dataset

```{r}
hourly_step$ActivityHour=as.POSIXct(hourly_step$ActivityHour,format="%m/%d/%Y %I:%M:%S %p")
hourly_step$Hour <-  format(hourly_step$ActivityHour,format= "%H")
head(hourly_step)
```


# 4. Analyse and Share

### Checking to see if all users are unique

```{r}
n_distinct(daily_activity$Id)
n_distinct(sleep_day$Id)
n_distinct(weight$Id)
```

* There are supposed to be 30 users or 30 IDs. 
* The dataset has 3 extra from daily activity, 6 less from the sleep day table, and 22 less from the weight table. 

### Since weight table only has 8 users enter their information, let's take a look at how they enter the information

```{r}
weight %>% 
  filter(IsManualReport == "True") %>% 
  group_by(Id) %>% 
  summarise("Manual Weight Report"=n()) %>%
  distinct()
```

* 5 users are manually reporting the weight and 3 users are reporting it with a device connected to a connected (wifi). 


### Weekly and hourly summary

#### Weekly

##### On which days are the users most active in recording their data? 

```{r}
library(ggplot2)
ggplot(data=merged_data, aes(x=Weekday, fill=Weekday)) +
  geom_bar() +
  labs(title="Data Recording During the Week", x="Day of the Week", y="Number of Days the Data recorded" )
```

* It is observed that the users track their data more on Tuesdays, Wednesdays and Thursdays as compared to the other days of the week.

##### On which days the users take more steps? 

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=TotalSteps, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Total Steps taken during different Days of the Week", x="Day of the Week", y="Total Steps")
```

* Most steps are taken on Tuesday followed by Saturday and least on Sunday.

##### Average number of steps by day of the week 

```{r}
weekly_steps_summary <- merged_data %>% 
  group_by(Weekday) %>%
  summarize(avg_steps = mean(TotalSteps))

ggplot(data=weekly_steps_summary, aes(x=Weekday, y=avg_steps, fill=Weekday))+
  geom_bar(stat="identity")+
  labs(title="Average Steps in each Day", x="Day of the Week", y="Average Number of Steps")
```

* Most Average number of steps are taken on Saturday, followed by Monday.
* Least Average number of steps are taken on Sunday.

##### On which days the users burn more calories? 

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=Calories, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Total Calories burned during different Days of the Week", x="Day of the Week", y="Calories Burned")
```

* Most Calories are burned on Tuesday and least on Sunday.
* It seems that there is some relationship between Total Steps taken and Calories Burned.

##### Average Calories burnt by day of the week 

```{r}
weekly_calories_summary <- merged_data %>% 
  group_by(Weekday) %>%
  summarize(avg_calories = mean(Calories))

ggplot(data=weekly_calories_summary, aes(x=Weekday, y=avg_calories, fill=Weekday))+
  geom_bar(stat="identity")+
  labs(title="Average Calories burnt in each Day", x="Day of the Week", y="Average Calories burnt")
```

* Most Average Calories are burnt on Saturday, followed by Monday.
* Least Average Calories are burnt on Sunday.

##### Exploring the relationship between Total Steps and Calories

```{r}
ggplot(data=merged_data, aes(x=TotalSteps, y = Calories))+ 
  geom_point()+ 
  labs(title="Total Steps vs Calories")+
  xlab("Total Steps")+
  stat_smooth(method=lm)+
  scale_color_gradient(low="orange", high="steelblue")
```

* There is a positive correlation between Total Steps and Calories.
* More number of steps a user takes, more calories they burn.


##### On which days the users spend more time sleeping? 

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=TotalMinutesAsleep, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Total Minutes Asleep During the Week", x="Day of the Week", y="Total Minutes Asleep")
```

* Users spend the most time sleeping on Tuesdays, Wednesdays and Thursdays as compared to the other days of the Week.

##### On which days the users spend more time in bed?

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=TotalTimeInBed, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Total Time in Bed during the Week", x="Day of the Week", y="Total Time in Bed")
```

* Users spend the most time in bed on Tuesdays, Wednesdays and Thursdays as compared to the other days of the Week.
* There seems to be a relationship between Total Minutes Asleep and Total Time in Bed.

##### Exploring the relationship between Total Minutes Asleep and Total Time in Bed

```{r}
ggplot(data=merged_data, aes(x=TotalTimeInBed, y = TotalMinutesAsleep))+ 
  geom_point()+ 
  labs(title="Total Minutes Asleep vs Total Time in Bed")+
  xlab("Total Time in Bed")+
  ylab("Total Minutes Asleep")+
  stat_smooth(method=lm)+
  scale_color_gradient(low="orange", high="steelblue")
```

* There is a strong positive correlation between Total Minutes Asleep and Total Time in Bed.

##### On which days the users spend more Sedentary Minutes?

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=SedentaryMinutes, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Sedentary Minutes during the Week", x="Day of the Week", y="Sedentary Minutes")
```

* Users spend least Sedentary Minutes on Saturday and most on Tuesday.

##### Average Sedentary Minutes by day of the week 

```{r}
weekly_sedentary_summary <- merged_data %>% 
  group_by(Weekday) %>%
  summarize(avg_sedentary_minutes = mean(SedentaryMinutes))

ggplot(data=weekly_sedentary_summary, aes(x=Weekday, y=avg_sedentary_minutes, fill=Weekday))+
  geom_bar(stat="identity")+
  labs(title="Average Sedentary Minutes in each Day", x="Day of the Week", y="Average Sedentary Minutes")
```

* Users spend most Average Sedentary Minutes pn Friday followed by Sunday.
* Users spend least Average Sedentary Minutes on Thursday followed by Saturday.

##### On which days the users spend more Very Active Minutes?

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=VeryActiveMinutes, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Very Active Minutes during the Week", x="Day of the Week", y="Very Active Minutes")
```

* Users spend most Very Active Minutes on Tuesday and Saturday and least on Sunday and Friday.

##### Average Very Active Minutes by day of the week 

```{r}
weekly_veryactive_summary <- merged_data %>% 
  group_by(Weekday) %>%
  summarize(avg_veryactive_minutes = mean(VeryActiveMinutes))

ggplot(data=weekly_veryactive_summary, aes(x=Weekday, y=avg_veryactive_minutes, fill=Weekday))+
  geom_bar(stat="identity")+
  labs(title="Average Very Active Minutes in each Day", x="Day of the Week", y="Average Very Active Minutes")
```

* Users spend most Average Very Active Minutes on Tuesday and Saturday.
* Users spend least Average Very Active Minutes on Sunday and Friday.

##### On which days the users cover more Distance?

```{r}
ggplot(data=merged_data, aes(x=Weekday, y=TotalDistance, fill=Weekday))+ 
  geom_bar(stat="identity")+
  labs(title="Total Distance covered during the Week", x="Day of the Week", y="Total Distance")
```

* Users cover most Distance on Tuesday and least on Sunday.
* There seems to be some relationship between Very Active Minutes and Total Distance, between Total Distance and Calories, and between Total Distance and Total Steps.

##### Average Distance by day of the week 

```{r}
weekly_distance_summary <- merged_data %>% 
  group_by(Weekday) %>%
  summarize(avg_distance = mean(TotalDistance))

ggplot(data=weekly_distance_summary, aes(x=Weekday, y=avg_distance, fill=Weekday))+
  geom_bar(stat="identity")+
  labs(title="Average Distance in each Day", x="Day of the Week", y="Average Distance")
```

* Users cover most Average Distance on Monday followed by Saturday.
* Users cover least Average Distance on Sunday and Friday. 

##### Exploring the relationship between Very Active Minutes and Total Distance

```{r}
ggplot(data=merged_data, aes(x=TotalDistance, y=VeryActiveMinutes))+ 
  geom_point()+ 
  labs(title="Very Active Minutes vs Total Distance")+
  xlab("Total Distance")+
  ylab("Very Active Minutes")+
  stat_smooth(method=lm)
```

* There is a positive correlation between Total Distance and Very Active Minutes.

##### Exploring the relationship between Calories and Total Distance

```{r}
ggplot(data=merged_data, aes(x=TotalDistance, y=Calories))+ 
  geom_point()+ 
  labs(title="Calories vs Total Distance")+
  xlab("Total Distance")+
  ylab("Calories")+
  stat_smooth(method=lm)
```

* There is a positive correlation between Total Distance and Calories.

##### Exploring the relationship between Total Steps and Total Distance

```{r}
ggplot(data=merged_data, aes(x=TotalDistance, y=TotalSteps))+ 
  geom_point()+ 
  labs(title="Total Steps vs Total Distance")+
  xlab("Total Distance")+
  ylab("Total Steps")+
  stat_smooth(method=lm)
```

* There is a strong positive linear relationship between Total Distance and Total Steps.


#### Hourly

##### How many users recorded their hourly data?

```{r}
n_distinct(hourly_step$Id) 
```

* 33 Users recorded their hourly data

##### During which hours the users take the most steps?

```{r}
ggplot(data=hourly_step, aes(x=Hour, y=StepTotal, fill=Hour))+
  geom_bar(stat="identity")+
  labs(title="Hourly Steps", x="Hour of the Day", y="Total Steps")
```

* Users take most steps between 12-2 pm and between 5-7 pm.
* Steps taken by users increases from 5 am in the morning, and decreases in the afternoon until 3 pm. 
* The steps increases again from 3 pm until 6 pm and then decreases until 3 am on the following day.


### Statistics summary mean, median, min, max for all 3 tables + merged data

```{r}
merged_data %>%
  select(Weekday,
         TotalSteps,
         TotalDistance,
         VeryActiveMinutes,
         FairlyActiveMinutes,
         LightlyActiveMinutes,
         SedentaryMinutes,
         Calories,
         TotalMinutesAsleep,
         TotalTimeInBed,
         WeightPounds,
         BMI) %>%
  summary()
```

* Average weight is 139.6 pounds with BMI of 24.42 and users burn approximately 2100 calories. 
* Average steps are 9373, maximum steps are almost more than triple of average steps, i.e., 36000 steps. 
* Users spend on average 12 hours a day in sedentary minutes, 4 hours lightly active, only 42 minutes in fairly + very active minutes.
* Users also get about 7 hour of sleep each day.

### Analysis on active minutes, calorie, and total steps. 

The American Heart Association and World Health Organization recommend at least 150 minutes of moderate-intensity activity or 75 minutes of vigorous activity, 
or a combination of both, each week. That means it needs an daily goal of 21.4 minutes of FairlyActiveMinutes or 10.7 minutes of VeryActiveMinutes.

##### Active users

```{r}
active_users <- daily_activity %>%
  filter(FairlyActiveMinutes >= 21.4 | VeryActiveMinutes>=10.7) %>% 
  group_by(Id) %>%
  count(Id)
active_users
```

* 30 users met the criteria of fairly active minutes or very active minutes.


Creating variables for % of Different Activity Level Minutes

```{r}
total_minutes <- sum(daily_activity$SedentaryMinutes, daily_activity$VeryActiveMinutes, daily_activity$FairlyActiveMinutes, daily_activity$LightlyActiveMinutes)
sedentary_percentage <- sum(daily_activity$SedentaryMinutes)/total_minutes*100
lightly_percentage <- sum(daily_activity$LightlyActiveMinutes)/total_minutes*100
fairly_percentage <- sum(daily_activity$FairlyActiveMinutes)/total_minutes*100
active_percentage <- sum(daily_activity$VeryActiveMinutes)/total_minutes*100
```

##### Pie chart showing % of Different Activity Level Minutes

```{r}
percentage <- data.frame(
  level=c("Sedentary", "Lightly", "Fairly", "Very Active"),
  minutes=c(sedentary_percentage,lightly_percentage,fairly_percentage,active_percentage))

plot_ly(percentage, labels = ~level, values = ~minutes, type = 'pie',textposition = 'outside',textinfo = 'label+percent') %>%
  layout(title = 'Activity Level Minutes',
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))
```

* Sedentary Minutes (81.3%) occupy the highest proportion of the Total Minutes, meaning the users mostly spend time being inactive. 
* Fairly Active Minutes (1.11%) and Very Active Minutes (1.74%) occupy a very less proportion of the Total Minutes, meaning the users are active for very less time.


##### How active are the users

```{r fig.align="center", echo = FALSE, fig.width = 10}
active_minute <- daily_activity %>% 
  gather(key=Intensity, value=active_minutes, ends_with("minutes")) %>% 
  select(Intensity, active_minutes) 
  
ggplot(data=active_minute, aes(x=Intensity, y=active_minutes))+
  geom_boxplot(aes(fill=Intensity))+
  scale_x_discrete(limits=c("SedentaryMinutes","LightlyActiveMinutes","FairlyActiveMinutes","VeryActiveMinutes"))+
  ylab("Minutes")
```

* Sedentary Minutes have the most widely spread values in the dataset.
* Fairly Active Minutes and Very Active Minutes have quite a few outliers in the dataset.

##### Total steps vs Sedentary Minutes with Calories and Total Distance

```{r}
par(mfrow = c(2, 2))
ggplot(data=daily_activity, aes(x=TotalSteps, y=SedentaryMinutes, color=Calories))+ 
  geom_point()+
  stat_smooth(method=lm)+
  scale_color_gradient(low="blue", high="yellow")
```

```{r}
ggplot(data=daily_activity, aes(x=TotalSteps, y=SedentaryMinutes, color=TotalDistance))+ 
  geom_point()+
  stat_smooth(method=lm)+
  scale_color_gradient(low="blue", high="yellow")
```

* The two plots are very similar. 
* Users who are more active burn more calories, whereas users who are sedentary take the less steps and burn less calories.

##### Interesting find here that some user who are sedentary, takes minimal step, but still able to burn over 1500 to 2500 calories

```{r}
ggplot(data=daily_activity, aes(x=TotalSteps, y = Calories, color=SedentaryMinutes))+ 
  geom_point()+ 
  labs(title="Total Steps vs Calories")+
  xlab("Total Steps")+
  stat_smooth(method=lm)+
  scale_color_gradient(low="orange", high="steelblue")
```

* The more active a user is, the more steps they take, and the more calories they burn. This is an obvious fact, but the same was verified using data.
* It was observed that some users who are sedentary, take minimal steps, but still able to burn over 1500 to 2500 calories as compared to users who are more active, take more steps, but still burn similar calories.


##### Users who take more steps, burn more calories and has lower BMI

```{r}
ggplot(data=merged_data, aes(x=TotalSteps, y = BMI, color=Calories))+ 
  geom_point()+ 
  stat_smooth(method=lm)+
   scale_color_gradient(low="blue", high="yellow")
```

* Users who take more steps, burn more calories and has lower BMI
* There are some outliers in the top left corner.

##### Regression analysis and R value, leverage points (lm.influence)

The lm() analysis, gives information about the the R-squared value.
0% indicates that the model explains none of the variability of the response data around its mean. 
100% indicates that the model explains all the variability of the response data around its mean. 
Postive slope means variables increase/decrease with each other, and negative means one variable goes up and the other goes down.

```{r}
step_vs_sedentary.mod <- lm(SedentaryMinutes ~ TotalSteps, data = merged_data)
summary(step_vs_sedentary.mod)
```

* Sedentary Minutes decrease by 0.0094864 minutes for every 1 step increase in Total Steps (or 9.49 Sedentary Minutes decrease for every 1000 step increase in Total Steps).
* Total Steps explained around 3.81% variation in the Sedentary Minutes.
* p value is less than the significance level, hence the results are statistically significant.

```{r}
bmi_vs_steps.mod <- lm(BMI ~ TotalSteps, data = merged_data)
summary(bmi_vs_steps.mod)
```

* BMI decrease by 0.000094039 for every 1 step increase in Total Steps (or 9.40 BMI decrease for every 100000 step increase in Total Steps).
* Total Steps explained around 4.05% variation in the BMI.
* p value is less than the significance level, hence the results are statistically significant.

```{r}
calories_vs_steps.mod <- lm(Calories ~ TotalSteps, data = merged_data)
summary(calories_vs_steps.mod)
```

* Calories increase by 0.067 units for every 1 step increase in Total Steps (or 67 units Calories increase for every 1000 step increase in Total Steps).
* Total Steps explained around 27.9% variation in the Calories.
* p value is less than the significance level, hence the results are statistically significant.


```{r}
veryactive_vs_sleep.mod <- lm(VeryActiveMinutes ~ TotalMinutesAsleep, data = merged_data)
summary(veryactive_vs_sleep.mod)

```

* Very Active Minutes decrease by 0.002 for every 1 Minute increase in Total Minutes Asleep (or 2 Very Active Minutes decrease for every 1000 Minute increase in Total Minutes Asleep).
* p value is greater than the significance level, hence the results are not statistically significant.

##### The high volume of moderate-to-vigorous physical activity is achieved by a very small proportion of the population

```{r}
active_minutes_vs_calories <- ggplot(data = merged_data) + 
  geom_point(mapping=aes(x=Calories, y=FairlyActiveMinutes), color = "maroon", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x, mapping=aes(x=Calories, y=FairlyActiveMinutes, color=FairlyActiveMinutes), color = "maroon", se = FALSE) +
  
  geom_point(mapping=aes(x=Calories, y=VeryActiveMinutes), color = "forestgreen", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=Calories, y=VeryActiveMinutes, color=VeryActiveMinutes), color = "forestgreen", se = FALSE) +
  
  geom_point(mapping=aes(x=Calories, y=LightlyActiveMinutes), color = "orange", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=Calories, y=LightlyActiveMinutes, color=LightlyActiveMinutes), color = "orange", se = FALSE) +
  
  geom_point(mapping=aes(x=Calories, y=SedentaryMinutes), color = "steelblue", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=Calories, y=SedentaryMinutes, color=SedentaryeMinutes), color = "steelblue", se = FALSE) +
  
  annotate("text", x=4800, y=160, label="Very Active", color="black", size=3)+
  annotate("text", x=4800, y=0, label="Fairly Active", color="black", size=3)+
  annotate("text", x=4800, y=500, label="Sedentary", color="black", size=3)+
  annotate("text", x=4800, y=250, label="Lightly  Active", color="black", size=3)+
  labs(x = "Calories", y = "Active Minutes", title="Calories vs Active Minutes")
active_minutes_vs_calories
```

* According to this healthline.com [article](https://www.healthline.com/nutrition/how-many-calories-per-day#average-calorie-needs), moderately active woman between the ages of 26-50 needs to eat about 2,000 calories per day and moderately active man between the ages of 26-45 needs 2,600 calories per day to maintain his weight.
* Comparing the four active levels to the calories, we see most data is concentrated on users who burn 2000 to 3000 calories a day. 
* These users also spent an average between 8 to 13 hours in sedentary, 5 hours in lightly active, and 1 to 2 hour for fairly and very active. 
* Additionally, we see that the sedentary line is leveling off toward the end while fairly + very active line is curling back up. 
* This indicates that the users who burn more calories spend less time in sedentary, more time in fairly + active.

```{r}
active_minutes_vs_steps <- ggplot(data = merged_data) + 
  geom_point(mapping=aes(x=TotalSteps, y=FairlyActiveMinutes), color = "maroon", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x, mapping=aes(x=TotalSteps, y=FairlyActiveMinutes, color=FairlyActiveMinutes), color = "maroon", se = FALSE) +
  
  geom_point(mapping=aes(x=TotalSteps, y=VeryActiveMinutes), color = "forestgreen", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=TotalSteps, y=VeryActiveMinutes, color=VeryActiveMinutes), color = "forestgreen", se = FALSE) +
  
  geom_point(mapping=aes(x=TotalSteps, y=LightlyActiveMinutes), color = "orange", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=TotalSteps, y=LightlyActiveMinutes, color=LightlyActiveMinutes), color = "orange", se = FALSE) +
  
   geom_point(mapping=aes(x=TotalSteps, y=SedentaryMinutes), color = "steelblue", alpha = 1/3) +
  geom_smooth(method = loess,formula =y ~ x,mapping=aes(x=TotalSteps, y=SedentaryMinutes, color=SedentaryMinutes), color = "steelblue", se = FALSE) +
  
  annotate("text", x=35000, y=150, label="Very Active", color="black", size=3)+
  annotate("text", x=35000, y=50, label="Fairly Active", color="black", size=3)+
  annotate("text", x=35000, y=1350, label="Sedentary", color="black", size=3)+
  annotate("text", x=35000, y=380, label="Lightly  Active", color="black", size=3)+
  labs(x = "Total Steps", y = "Active Minutes", title="Steps vs Active Minutes")
active_minutes_vs_steps
```

* Comparing the four active levels to the total steps, it can be seen that most data is concentrated on users who take about 5000 to 15000 steps a day. 
* These users spent an average between 8 to 13 hours in sedentary, 5 hours in lightly active, and 1 to 2 hour for fairly and very active minutes respectively.


### Analysis on sleep

##### Converting the Sleep time in hours instead of minutes

```{r}
sleep_day_in_hour <-sleep_day
sleep_day_in_hour$TotalMinutesAsleep <- sleep_day_in_hour$TotalMinutesAsleep/60
sleep_day_in_hour$TotalTimeInBed <- sleep_day_in_hour$TotalTimeInBed/60
head(sleep_day_in_hour)
```

##### Checking for any sleep outliers 

Number of times user sleep or spend time in bed for more than 10 hours 

```{r}
sum(sleep_day_in_hour$TotalMinutesAsleep > 10)
sum(sleep_day_in_hour$TotalTimeInBed > 10)
```

Number of times user sleep or spend time in bed for less than 1 hour

```{r}
sum(sleep_day_in_hour$TotalMinutesAsleep < 1)
sum(sleep_day_in_hour$TotalTimeInBed < 1)
```

Referring this [article](https://blog.fitbit.com/sleep-study/#:~:text=The%20average%20Fitbit%20user%20is,is%20spent%20restless%20or%20awake.&text=People%20who%20sleep%205%20hours,the%20beginning%20of%20the%20night), 55 minutes are spend awake in bed before going to sleep. 

##### Let see how many users in this analysis corresponds to the FitBit data

```{r}
awake_in_bed <- mutate(sleep_day, AwakeTime = TotalTimeInBed - TotalMinutesAsleep)
awake_in_bed <- awake_in_bed %>% 
  filter(AwakeTime >= 55) %>% 
  group_by(Id) %>% 
  arrange(AwakeTime, desc=TRUE) 
  
n_distinct(awake_in_bed$Id)
```

* 13 users spend more than 55 minutes in bed before falling alseep

How many minutes an user sleep may not correlate well with how actively they are, but sedentary time account for about 80% of during the day

##### Using Regression Analysis to find if users who spend more time in sedentary minutes also spend more time sleeping 

```{r}
sedentary_vs_sleep.mod <- lm(SedentaryMinutes ~ TotalMinutesAsleep, data = merged_data)
summary(sedentary_vs_sleep.mod)
```

* Sedentary Minutes decrease by 0.442 for every 1 Minute increase in Total Minutes Asleep (or 44.2 Sedentary Minutes decrease for every 100 Minute increase in Total Minutes Asleep).
* Total Minutes Asleep explained around 4.30% variation in the Sedentary Minutes.
* p value is less than the significance level, hence the results are statistically significant.


##### Finding the relationship between Total Minutes Asleep and Calories by Total Steps to find out "Do people sleep more burn less calories?"

```{r}
ggplot(data=merged_data, aes(x=TotalMinutesAsleep/60, y=Calories, color=TotalSteps))+ 
  geom_point()+
  labs(title="Total Minutes Asleep vs Calories")+
  xlab("Total Minutes Alseep")+
  stat_smooth(method=lm)+
  scale_color_gradient(low="orange", high="steelblue")
```

* Majority of the users sleep between 5 to 10 hours burns around 1500 to 4500 calories a day.
* There is not much a correlation.



# 6. Act

### Main insights and conclusions

Some of the key findings from the analysis are as follows:

* Users track their data more on Tuesdays, Wednesdays, and Thursdays as compared to other days of the week.
* Most steps are taken on Tuesday, followed by Saturday, and the least on Sunday.
* Users spend the most time sleeping and in bed on Tuesdays, Wednesdays, and Thursdays.
* Users spend the most sedentary minutes on Friday and the least on Saturday.
* Users cover most distance on Tuesday and the least on Sunday.
* Users take most steps between 12-2 pm and between 5-7 pm.
* Users who are more active burn more calories, whereas users who are sedentary take less steps and burn fewer calories.
* The more active a user is, the more steps they take, and the more calories they burn.
* Some users who are sedentary, take minimal steps, but still able to burn over 1500 to 2500 calories as compared to users who are more active, take more steps, but still burn similar calories.
* Users who take more steps, burn more calories and have lower BMI.
* Sedentary minutes make up a significant portion, 81% of users total minutes.
* Users spend on average 12 hours a day in sedentary minutes, 4 hours lightly active minutes, and only 42 minutes in fairly + very active minutes.
* 54% of the users who recorded their sleep data spent 55 minutes awake in bed before falling asleep.


### Marketing recommendations to expand globally

Based on the findings from the Bellabeat case study, the marketing team can consider the following strategies to grow the business:

* Target users on Tuesdays, Wednesdays, and Thursdays: As users track their data more on these days, the marketing team can plan promotional campaigns or special offers during these days to encourage more purchases.

* Focus on promoting the benefits of being active: Since users who are more active burn more calories, take more steps, and have lower BMI, the marketing team can promote the benefits of being active through social media, blog posts, or partnerships with fitness influencers.

* Encourage users to take more steps: As users take most steps between 12-2 pm and between 5-7 pm, the marketing team can consider incentivizing users to take more steps during these times. For example, they can offer discounts or rewards for users who reach a certain step count during these hours.

* Address sedentary behavior: Given that sedentary minutes make up a significant portion of users' total minutes, the marketing team can focus on promoting the importance of reducing sedentary behavior through social media, email campaigns, or blog posts.

* Address sleep issues: Since 54% of users who recorded their sleep data spent 55 minutes awake in bed before falling asleep, the marketing team can develop content or products that address sleep issues such as tips to improve sleep quality or the introduction of a new product feature that helps users fall asleep faster.

* Segment users based on their activity level: Since users who are sedentary take fewer steps and burn fewer calories, the marketing team can segment users based on their activity level and tailor marketing messages to each segment. For example, they can develop campaigns to encourage sedentary users to take more steps or offer discounts to active users to maintain their level of activity.

* Obtain more data for an accurate analysis, encouraging users to use a wifi-connected scale instead of manual weight entries.

* Educational healthy style campaign encourages users to have short active exercises during the week, longer during the weekends, especially on Sunday where we see the lowest steps and most sedentary minutes.

* Educational healthy style campaign can pair with a point-award incentive system. Users completing the whole week's exercise will receive Bellabeat points on products/memberships.

* The product, such as Leaf wellness tracker, can beat or vibrate after a prolonged period of sedentary minutes, signaling the user it's time to get active! Similarly, it can also remind the user it's time to sleep after sensing a prolonged awake time in bed.

Overall, the marketing team can use these findings to inform their marketing strategy and create more targeted and effective campaigns that meet the specific needs and preferences of Bellabeat users.


















